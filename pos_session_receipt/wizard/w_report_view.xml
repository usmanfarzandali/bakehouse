<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <record id="view_pos_session_end_inherit_pos_sale" model="ir.ui.view">
            <field name="name">pos.session.end.view</field>
            <field name="model">pos.session</field>
            <field name="inherit_id" ref="point_of_sale.view_pos_session_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='start_at']" position="after">
                    <field name="session_end_user" attrs="{'invisible' : [('state', '!=', 'closed')]}" />
                </xpath>
            </field>
        </record>

        <!-- Inherit Form View to Modify it -->
        <record id="view_account_bnk_stmt_cashbox_modify" model="ir.ui.view">
            <field name="name">account.bnk_stmt_cashbox.form</field>
            <field name="model">account.bank.statement.cashbox</field>
            <field name="inherit_id" ref="point_of_sale.view_account_bnk_stmt_cashbox"/>
            <field name="arch" type="xml">
                <xpath expr="//sheet" position="replace">
                    <sheet>
                        <field name="start_bank_stmt_ids" invisible="1"/>
                        <field name="end_bank_stmt_ids" invisible="1"/>
                        <field name="currency_id" invisible="1"/>
                        <field name="cashbox_lines_ids" nolabel="1" context="{'default_currency_id': currency_id}"
                               style="padding: 2px;">
                            <tree editable="bottom" create="0" delete="0">
                                <field name="currency_id" invisible="1"/>
                                <field name="number"/>
                                <field name="coin_value" readonly="1" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                <field name="subtotal" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                            </tree>
                        </field>
                        <div>
                            <group>
                                <group class="oe_subtotal_footer oe_right" cols="6">
                                    <field name="currency_id" invisible="1"/>
                                    <div class="o_td_label"></div>
                                    <field name="total" widget="monetary" options="{'currency_field': 'currency_id'}"/>
                                </group>
                            </group>
                        </div>
                    </sheet>
                </xpath>
            </field>
        </record>

        <record id="view_pos_w_report_wizard" model="ir.ui.view">
            <field name="name">w.report.wizard.form</field>
            <field name="model">w.report.wizard</field>
            <field name="arch" type="xml">
                <form string="Session Report">
                    <group style="width: 50%; margin-left: 25%;">
<!--						<field name="pos_sessions_ids" widget="many2many_tags" />-->
                        <field name="pos_sessions_ids"/>
                    </group>
<!--					<group>-->
<!--						<field name="report_type" />-->
<!--					</group>-->
                    <footer style="margin-left: 40%;">
                        <button name="generate_w_report" string="Print" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="action_w_report" model="ir.actions.act_window">
            <field name="name">Session Thermal Receipt</field>
            <field name="res_model">w.report.wizard</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <record id="paperformat_report" model="report.paperformat">
            <field name="name">Session Thermal Receipt</field>
            <field name="default" eval="True"/>
            <field name="format">custom</field>
            <field name="page_height">550</field>
            <field name="page_width">96</field>
            <field name="orientation">Portrait</field><!--            <field name="orientation">Landscape</field>-->
            <field name="margin_top">0</field>
            <field name="margin_bottom">0</field>
            <field name="margin_left">0</field>
            <field name="margin_right">0</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">50</field>
            <field name="dpi">96</field>
        </record>

        <record id="action_w_report_print" model="ir.actions.report">
            <field name="name">Session Thermal Receipt</field>
            <field name="model">w.report.wizard</field>
            <field name="report_type">qweb-pdf</field>
            <field name="report_name">pos_session_receipt.receipt_closed_session</field>
            <field name="report_file">pos_session_receipt.receipt_closed_session</field>
            <field name="paperformat_id" ref="pos_session_receipt.paperformat_report"/>
            <field name="binding_type">report</field>
        </record>

        <menuitem id="menu_report_parent"
                  name="Session Receipt"
                  action="action_w_report"
                  parent="point_of_sale.menu_point_root" sequence="20"
                  groups="pos_session_receipt.group_session_receipt"/>

<!--        <menuitem-->
<!--                id="w_report_1"-->
<!--                name="Session Receipt"-->
<!--                action="action_w_report"-->
<!--                sequence="1"-->
<!--                parent="menu_report_parent" />-->
<!--                parent="point_of_sale.pos_config_menu_catalog" />-->
<!--            parent="point_of_sale.menu_point_rep" />-->
<!--            parent="point_of_sale.model_pos_session" />-->
<!--            parent="point_of_sale.menu_point_config_product"-->

        <template id="receipt_closed_session">
            <t t-call="web.html_container">
                <t t-call="web.internal_layout">
                    <div class="page" style="width: 302px;">
                        <div style="padding: 5px;"></div>
<!--                            <div style="font-size: 24px; border: 1px solid #333; padding: 15px;">-->
                        <div style="font-size: 18px; padding: 5px;">

                            <div class="text-center"
                                 style="padding: 5px; margin: 5px;"><!--                                    <span><u>UCC-JT</u></span>-->
                                <span>
                                    <u>
                                        <span t-esc="company_name"/>
                                    </u>
                                </span>
                            </div>

                            <div class="text-center"
                                 style="font-size: 16px; padding: 1px; margin: 5px; border: 1px solid #333; box-shadow: 3px 3px 3px 1px #333;">
                                <span>
                                    <strong>POS Session Activity Report</strong>
                                </span>
                            </div>

                            <div class="text-center"
                                 style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;"><!--                                    <span><strong>Counter : POS-NAVEED</strong></span>-->
                                <strong>Counter :
                                    <span t-esc="sessions_config_id"/>
                                </strong>
                            </div>

                            <div class="text-center"
                                 style="padding: 5px; margin: 5px; border: 1px solid #333;"><!--                                    <span><strong>Shift # 1 - POSid [16859]</strong></span>-->
                                <strong>POS-Session [<span t-esc="num_sessions"/>]
                                </strong>
                            </div>

                            <div class="text-center" style="padding: 5px; margin: 5px; border: 1px solid #333;">
                                <table class="table table-sm o_main_table text-left"
                                       style="font-size: 12px; padding: 5px; font-weight: bold; margin: 5px; width: 98%;">
                                    <tbody>
                                        <tr>
                                            <td>
                                                <span>Opening Date:</span>
                                            </td>
                                            <td><!--                                                    <span>30-Jul-2022 Sat 7:32:44 AM</span>-->
                                                <span t-esc="sessions_start_at"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span>Closing Date:</span>
                                            </td>
                                            <td><!--                                                    <span>30-Jul-2022 Sat 9:39:01 PM</span>-->
                                                <span t-esc="sessions_stop_at"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>
                                                <span>Session Open Operator:</span>
                                            </td>
                                            <td><!--                                                    <span>Naveed Manzoor</span>-->
                                                <span t-esc="sessions_user_id or 'Aun'"/>
                                            </td>
                                        </tr>
                                        <tr t-if="session_end_by">
                                            <td>
                                                <span>Session Closed Operator:</span>
                                            </td>
                                            <td>
                                                <t t-esc="session_end_by" />
                                            </td>
                                        </tr><!--                                    <tr>--><!--                                        <td>--><!--                                            <span>Remarks:</span>--><!--                                        </td>--><!--                                        <td>--><!--                                            <span>TILL:(NO.1)TID:(60110136)</span>--><!--                                        </td>--><!--                                    </tr>-->
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <div class="text-center"
                                     style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;">
                                    <span>
                                        <strong>POS DOCUMENT ACTIVITY</strong>
                                    </span>
                                </div>
                                <table class="table table-sm o_main_table"
                                       style="font-size: 12px; padding: 5px; margin: 5px; width: 98%;">
                                    <thead>
                                        <tr>
                                            <th class="text-center">
                                                <strong>Document Type</strong>
                                            </th>
                                            <th class="text-center">
                                                <strong># Of Doc.</strong>
                                            </th>
                                            <th class="text-center">
                                                <strong>Amount</strong>
                                            </th>
                                            <th class="text-center">
                                                <strong>Discount</strong>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left">
                                                <span>Sale Invoice</span>
                                            </td><!--                                                <td><span>100</span></td>-->
                                            <td>
                                                <span>
                                                    <t t-esc="total_orders"/>
                                                </span>
                                            </td>
                                            <td>
                                                <span>
                                                    <t t-esc="total_paid"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="total_paid" />-->
                                                </span>
                                            </td>
                                            <td>
                                                <span>
                                                    <t t-esc=" total_discount"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc=" total_discount" />-->
                                                </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>Sale Return</span>
                                            </td><!--                                                <td><span>1</span></td>-->
                                            <td>
                                                <span>
                                                    <t t-esc="return_orders"/>
                                                </span>
                                            </td><!--                                                <td><span>295</span></td>-->
                                            <td>
                                                <span>
                                                    <t t-esc="return_total"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="return_total" />-->
                                                </span>
                                            </td>
                                            <td>
                                                <span>0</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>- Net Amount</span>
                                            </td>
                                            <td>
                                                <span>
                                                    <t t-esc="total_orders + return_orders"/>
                                                </span>
                                            </td><!--                                                <td><span>295</span></td>-->
                                            <td>
                                                <span>
                                                    <t t-esc="total_paid - return_total"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="total_paid - return_total" />-->
                                                </span>
                                            </td>
                                            <td>
                                                <span>
                                                    <t t-esc="total_discount"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="total_discount" />-->
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <div class="text-center"
                                     style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;">
                                    <span>
                                        <strong>MODE OF PAYMENTS</strong>
                                    </span>
                                </div>
                                <table class="table table-sm o_main_table"
                                       style="font-size: 14px; padding: 5px; margin: 5px; width: 98%;">
                                    <thead>
                                        <tr>
                                            <th class="text-center">
                                                <strong>Payment Type</strong>
                                            </th>
                                            <th class="text-center">
                                                <strong># Of Doc.</strong>
                                            </th>
                                            <th class="text-center">
                                                <strong>Amount</strong>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td class="text-left">Sale - Cash</td>
                                            <td class="text-center">
                                                <t t-esc="total_orders - total_card_doc"/>
                                            </td>
                                            <td class="text-center">
                                                <t t-esc="total_cash_amt"
                                                   t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                            </td>
                                        </tr>
                                        <tr t-foreach='payments' t-as='payment'>
                                            <t t-if="'Card' in payment['name']">
                                                <td class="text-left">
                                                    <t t-esc="payment['name']"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="payment['count']"/>
                                                </td>
                                                <td class="text-center">
                                                    <t t-esc="payment['total']"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="payment['total']" />-->
                                                </td>
                                            </t>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>- Net Amount</span>
                                            </td>
                                            <td>
                                                <span>
                                                    <t t-esc="total_orders"/>
                                                </span>
                                            </td>
                                            <td>
                                                <span>
                                                    <t t-esc="total_card_amt + total_cash_amt"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <div class="text-center"
                                     style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;">
                                    <span>
                                        <strong>CASH RECEIVED SUMMARY</strong>
                                    </span>
                                </div>
                                <table class="table table-sm o_main_table"
                                       style="font-size: 16px; padding: 5px; margin: 5px; width: 98%;">
                                    <tbody>
                                        <tr>
                                            <td class="text-left">
                                                <span>Opening Amount</span>
                                            </td>
                                            <td class="text-right">
                                                <span>0</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">Sale - Cash</td>
                                            <td class="text-right">
                                                <t t-esc="total_cash_amt"
                                                   t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                            </td>
                                        </tr><!--                                            <tr t-foreach='payments' t-as='payment'>--><!--                                                <t t-if="'Cash' == payment['name']">--><!--                                                    <td class="text-left">Sale - <t t-esc="payment['name']" /></td>--><!--                                                    <td class="text-right">--><!--                                                        <t t-esc="payment['total']" t-options="{'widget': 'float', 'precision': currency_precision}"/>--><!--&lt;!&ndash;                                                        <t t-esc="payment['total']" />&ndash;&gt;--><!--                                                    </td>--><!--                                                </t>--><!--                                            </tr>-->
                                        <tr>
                                            <td class="text-left">
                                                <span>-</span>
                                            </td>
                                            <td class="text-right">
                                                <span>-</span>
                                            </td>
                                        </tr>
                                        <tr t-foreach='payments' t-as='payment'>
                                            <t t-if="'Cash' == payment['name']">
                                                <td class="text-left">
                                                    <span>Total Amount</span>
                                                </td>
                                                <td class="text-right">
                                                    <strong style="font-size: 18px;">
                                                        <t t-esc="payment['total']"
                                                           t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                            <t t-esc="payment['total']" />-->
                                                    </strong>
                                                </td>
                                            </t>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <div class="text-center"
                                     style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;">
                                    <span>
                                        <strong>CASH PAID SUMMARY</strong>
                                    </span>
                                </div>
                                <table class="table table-sm o_main_table"
                                       style="font-size: 16px; padding: 5px; margin: 5px; width: 98%;">
                                    <tbody>
                                        <tr>
                                            <td class="text-left">
                                                <span>Cash Bank/Sale Return</span>
                                            </td>
                                            <td class="text-right">
                                                <span>
                                                    <t t-esc="return_total"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="return_total" />-->
                                                </span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>-</span>
                                            </td>
                                            <td class="text-right">
                                                <span>-</span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>Total Amount</span>
                                            </td>
                                            <td class="text-right">
                                                <span style="font-size: 18px;">
                                                    <strong>
                                                        <t t-esc="return_total"
                                                           t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                            <t t-esc="return_total" />-->
                                                    </strong>
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <div class="text-center"
                                     style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;">
                                    <span>
                                        <strong>CURRENCY DENOMINATION</strong>
                                    </span>
                                </div>
                                <table class="table table-sm o_main_table"
                                       style="font-size: 16px; padding: 5px; margin: 5px; width: 98%;">
                                    <thead>
                                        <tr>
                                            <th class="text-center">Currency</th>
                                            <th class="text-left">QTY</th>
                                            <th class="text-right">Subtotal</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach="denomination" t-as="deno">
                                            <td class="text-center">
                                                <strong><t t-esc="deno"/>/=
                                                </strong>
                                            </td>
                                            <td class="text-left">
                                                <t t-esc="deno_value"/>
                                            </td>
                                            <td class="text-right">
                                                <t t-esc="deno * deno_value"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-center">
                                                <span>-</span>
                                            </td>
                                            <td class="text-left">-
                                                <span></span>
                                            </td>
                                            <td class="text-right">-
                                                <span></span>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>Total Amount</span>
                                            </td>
                                            <td class="text-left">
                                                <span></span>
                                            </td>
                                            <td class="text-right">
                                                <span style="font-size: 18px;"><!--                                                        <strong><t t-esc="cash_register_balance" t-options="{'widget': 'float', 'precision': currency_precision}" /></strong>-->
                                                    <strong>
                                                        <t t-esc="total_denomination"
                                                           t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                                    </strong>
                                                </span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <table class="table table-sm o_main_table"
                                       style="font-size: 16px; padding: 5px; border: 2px dashed #e6e6e6; margin: 5px; width: 98%;">
                                    <tbody>
                                        <tr style="border: 2px dashed #e6e6e6;">
                                            <td class="text-left">
                                                <span>Closing Cash Deposit</span>
                                            </td>
                                            <td class="text-right">
                                                <span style="font-size: 18px;">
                                                    <strong>
                                                        <t t-esc="cash_register_balance"
                                                           t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                                    </strong>
                                                </span>
                                            </td>
                                        </tr>
                                        <tr style="border: 2px dashed #e6e6e6;">
                                            <td class="text-left">
                                                <span>As Per Software</span>
                                            </td>
                                            <td class="text-right">
                                                <span style="font-size: 18px;">
                                                    <strong>
                                                        <t t-esc="cash_real_transaction"
                                                           t-options="{'widget': 'float', 'precision': currency_precision}"></t>
                                                    </strong>
                                                </span>
                                            </td>
                                        </tr>
                                        <t t-if="cash_difference_excess != 0">
                                            <tr style="border: 2px dashed #e6e6e6;">
                                                <td class="text-left">
                                                    <span>Excess Amount</span>
                                                </td>
                                                <td class="text-right">
                                                    <span style="font-size: 18px;">
                                                        <strong>
                                                            <span t-esc="cash_difference_excess"
                                                                  t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                                        </strong>
                                                    </span>
                                                </td>
                                            </tr>
                                        </t>
                                        <t t-elif="cash_difference_short != 0">
                                            <tr style="border: 2px dashed #e6e6e6;">
                                                <td class="text-left">
                                                    <span>Short Amount</span>
                                                </td>
                                                <td class="text-right">
                                                    <span style="font-size: 18px;">
                                                        <strong>
                                                            <span t-esc="cash_difference_short"
                                                                  t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                                        </strong>
                                                    </span>
                                                </td>
                                            </tr>
                                        </t>
                                        <tr style="border: 2px dashed #e6e6e6;">
                                            <td class="text-left">
                                                <span>Next POS Opening</span>
                                            </td>
                                            <td class="text-right">
                                                <span style="font-size: 18px;">
                                                    <strong>0</strong>
                                                </span>
                                            </td>
                                        </tr>
                                        <tr style="border: 2px dashed #e6e6e6;">
                                            <td class="text-left">
                                                <span>-</span>
                                            </td>
                                            <td class="text-right">
                                                <span>-</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                            <div class="text-center">
                                <div class="text-center"
                                     style="padding: 5px; margin: 10px 5px 5px 5px; border: 1px solid #333;">
                                    <span>
                                        <strong>CREDIT CARD MERCHANT SUMMARY</strong>
                                    </span>
                                </div>
                                <table class="table table-sm o_main_table"
                                       style="font-size: 16px; padding: 5px; margin: 5px; width: 98%;">
                                    <thead>
                                        <tr>
                                            <th class="text-left">
                                                <strong>
                                                    <u>Merchant Name</u>
                                                </strong>
                                            </th>
                                            <th class="text-center">
                                                <strong>
                                                    <u># Of Doc.</u>
                                                </strong>
                                            </th>
                                            <th class="text-center">
                                                <strong>
                                                    <u>Amount</u>
                                                </strong>
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr t-foreach='payments' t-as='payment'>
                                            <t t-if="'Card' in payment['name']">
                                                <td class="text-left">
                                                    <t t-esc="payment['name']"/>
                                                </td>
                                                <td>
                                                    <t t-esc="payment['count']"/>
                                                </td>
                                                <td>
                                                    <t t-esc="payment['total']"
                                                       t-options="{'widget': 'float', 'precision': currency_precision}"/>
                                                </td>
                                            </t>
                                        </tr>
                                        <tr>
                                            <td class="text-left">
                                                <span>-</span>
                                            </td>
                                            <td>
                                                <span>-</span>
                                            </td>
                                            <td>
                                                <span>-</span>
                                            </td>
                                        </tr>
                                        <tr style="font-weight: bolder;">
                                            <td class="text-left">
                                                <span>Total:</span>
                                            </td>
                                            <td>
                                                <t t-esc="total_card_doc"/>
                                            </td>
                                            <td>
                                                <t t-esc="total_card_amt"
                                                   t-options="{'widget': 'float', 'precision': currency_precision}"/><!--                                                        <t t-esc="total_card_amt" />-->
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                    </div>
                </t>
            </t>
        </template>

    </data>
</odoo>
